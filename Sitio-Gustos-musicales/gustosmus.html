<!DOCTYPE html>
<html>
  <head>
    <title>Gustos musicales</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.0.0/dist/tf.min.js"></script>
  </head>
  <body>
    <h1>Califica tus bandas favoritas</h1>
    <form id="form">
      <button type="button" onclick="processVotes()">Procesar información</button>
    </form>
    <h2 id="results"></h2>
    <script>
        const bands = ['Nirvana', 'Nine Inch Nails', 'Backstreet Boys', 'N Sync', 'Night Club', 'Apashe', 'STP']
        const features = ['Grunge', 'Rock', 'Industrial', 'Boy Band', 'Dance', 'Techno']
        const band_feats = tf.tensor([
          [1, 1, 0, 0, 0, 0],
          [1, 0, 1, 0, 0, 0],
          [0, 0, 0, 1, 1, 0],
          [0, 0, 0, 1, 0, 0],
          [0, 0, 1, 0, 0, 1],
          [0, 0, 1, 0, 0, 1],
          [1, 1, 0, 0, 0, 0],
        ])

        window.onload = () => {
          bands.forEach((band, i) => {
            document.getElementById('form').innerHTML += `<label for="vote-${i}">${band}</label><input type="number" id="vote-${i}" name="vote-${i}" min="1" max="10">`
          })
        }

        function processVotes() {
          const user_votes = bands.map((band, i) => parseInt(document.getElementById(`vote-${i}`).value) || 0)
          tf.tidy(() => {
            const user_feats = tf.matMul(tf.tensor([user_votes]), band_feats)
            const top_genres = tf.topk(user_feats, features.length).indices.arraySync()[0]
            document.getElementById('results').innerText = `Tus estilos de música favoritos son: ${top_genres.map((v) => features[v]).join(', ')}`
          })
        }
    </script>
  </body>
</html>
